// News Page JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // DOMË¶ÅÁ¥†„ÅÆÂèñÂæó
    const filterBtns = document.querySelectorAll('.filter-btn');
    const newsItems = document.querySelectorAll('.news-item');
    const searchInput = document.querySelector('.search-input');
    const searchBtn = document.querySelector('.search-btn');
    const readMoreBtns = document.querySelectorAll('.read-more-btn');
    const shareBtns = document.querySelectorAll('.share-btn');
    const noticeClose = document.querySelector('.notice-close');
    const newsletterForm = document.querySelector('.newsletter-signup');
    const paginationBtns = document.querySelectorAll('.pagination-number');
    const paginationPrev = document.querySelector('.pagination-btn.prev');
    const paginationNext = document.querySelector('.pagination-btn.next');

    // ÁèæÂú®„ÅÆ„Éï„Ç£„É´„Çø„Éº„Å®Ê§úÁ¥¢Áä∂ÊÖã
    let currentFilter = 'all';
    let currentSearchTerm = '';
    let currentPage = 1;
    let itemsPerPage = 6;

    // „Ç´„ÉÜ„Ç¥„É™„Éï„Ç£„É´„Çø„ÉºÊ©üËÉΩ
    filterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const category = this.dataset.category;
            currentFilter = category;
            currentPage = 1;
            
            // „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Éú„Çø„É≥„ÅÆÂàá„ÇäÊõø„Åà
            filterBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // „Éï„Ç£„É´„Çø„ÉºÈÅ©Áî®
            applyFilters();
            updatePagination();
        });
    });

    // Ê§úÁ¥¢Ê©üËÉΩ
    searchInput.addEventListener('input', debounce(function() {
        currentSearchTerm = this.value.toLowerCase();
        currentPage = 1;
        applyFilters();
        updatePagination();
    }, 300));

    searchBtn.addEventListener('click', function() {
        currentSearchTerm = searchInput.value.toLowerCase();
        currentPage = 1;
        applyFilters();
        updatePagination();
    });

    // Enter„Ç≠„Éº„Åß„ÅÆÊ§úÁ¥¢
    searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            searchBtn.click();
        }
    });

    function applyFilters() {
        let visibleItems = [];
        
        newsItems.forEach((item, index) => {
            const category = item.dataset.category;
            const title = item.querySelector('.news-title').textContent.toLowerCase();
            const excerpt = item.querySelector('.news-excerpt').textContent.toLowerCase();
            const tags = Array.from(item.querySelectorAll('.news-tag'))
                .map(tag => tag.textContent.toLowerCase());
            
            const matchesCategory = currentFilter === 'all' || category === currentFilter;
            const matchesSearch = currentSearchTerm === '' || 
                                title.includes(currentSearchTerm) || 
                                excerpt.includes(currentSearchTerm) ||
                                tags.some(tag => tag.includes(currentSearchTerm));
            
            if (matchesCategory && matchesSearch) {
                visibleItems.push(item);
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        });

        // Ê§úÁ¥¢ÁµêÊûú„ÅÆ„Éè„Ç§„É©„Ç§„Éà
        if (currentSearchTerm) {
            highlightSearchResults(visibleItems, currentSearchTerm);
        } else {
            removeHighlights();
        }

        // „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥Áî®„ÅÆ„Ç¢„Ç§„ÉÜ„É†ÁÆ°ÁêÜ
        updatePaginationDisplay(visibleItems);
        
        // ÁµêÊûú„Åå0‰ª∂„ÅÆÂ†¥Âêà„ÅÆË°®Á§∫
        showNoResultsMessage(visibleItems.length === 0);
    }

    function highlightSearchResults(items, searchTerm) {
        items.forEach(item => {
            const title = item.querySelector('.news-title');
            const excerpt = item.querySelector('.news-excerpt');
            
            highlightText(title, searchTerm);
            highlightText(excerpt, searchTerm);
        });
    }

    function highlightText(element, searchTerm) {
        const originalText = element.textContent;
        const regex = new RegExp(`(${searchTerm})`, 'gi');
        const highlightedText = originalText.replace(regex, '<span class="search-highlight">$1</span>');
        element.innerHTML = highlightedText;
    }

    function removeHighlights() {
        document.querySelectorAll('.search-highlight').forEach(highlight => {
            const parent = highlight.parentNode;
            parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
            parent.normalize();
        });
    }

    function showNoResultsMessage(show) {
        let noResultsMsg = document.querySelector('.no-results-message');
        
        if (show && !noResultsMsg) {
            noResultsMsg = document.createElement('div');
            noResultsMsg.className = 'no-results-message fade-in';
            noResultsMsg.innerHTML = `
                <div style="text-align: center; padding: 3rem; color: var(--neutral-gray);">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üì∞</div>
                    <h3 style="margin-bottom: 0.5rem;">Ë©≤ÂΩì„Åô„Çã„ÅäÁü•„Çâ„Åõ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</h3>
                    <p>Ê§úÁ¥¢Êù°‰ª∂„ÇíÂ§âÊõ¥„Åó„Å¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ</p>
                </div>
            `;
            document.querySelector('.news-grid').appendChild(noResultsMsg);
        } else if (!show && noResultsMsg) {
            noResultsMsg.remove();
        }
    }

    // „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥Ê©üËÉΩ
    function updatePaginationDisplay(visibleItems) {
        const totalItems = visibleItems.length;
        const totalPages = Math.ceil(totalItems / itemsPerPage);
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;

        // „Ç¢„Ç§„ÉÜ„É†„ÅÆË°®Á§∫„ÉªÈùûË°®Á§∫
        visibleItems.forEach((item, index) => {
            if (index >= startIndex && index < endIndex) {
                item.style.display = 'block';
                // „Éï„Çß„Éº„Éâ„Ç§„É≥„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
                setTimeout(() => {
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, index * 100);
            } else {
                item.style.display = 'none';
            }
        });
    }

    function updatePagination() {
        const visibleItemsCount = Array.from(newsItems).filter(item => 
            item.style.display !== 'none'
        ).length;
        const totalPages = Math.ceil(visibleItemsCount / itemsPerPage);

        // „Éö„Éº„Ç∏Áï™Âè∑„Éú„Çø„É≥„ÅÆÊõ¥Êñ∞
        paginationBtns.forEach((btn, index) => {
            const pageNum = index + 1;
            btn.classList.toggle('active', pageNum === currentPage);
        });

        // Ââç„Å∏„ÉªÊ¨°„Å∏„Éú„Çø„É≥„ÅÆÁä∂ÊÖãÊõ¥Êñ∞
        paginationPrev.disabled = currentPage === 1;
        paginationNext.disabled = currentPage === totalPages || totalPages === 0;
    }

    // „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„Éà
    paginationBtns.forEach((btn, index) => {
        btn.addEventListener('click', function() {
            currentPage = index + 1;
            applyFilters();
            updatePagination();
            
            // „Éà„ÉÉ„Éó„Å∏„Çπ„ÇØ„É≠„Éº„É´
            document.querySelector('.news-list').scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        });
    });

    paginationPrev.addEventListener('click', function() {
        if (currentPage > 1) {
            currentPage--;
            applyFilters();
            updatePagination();
        }
    });

    paginationNext.addEventListener('click', function() {
        const visibleItemsCount = Array.from(newsItems).filter(item => 
            item.style.display !== 'none'
        ).length;
        const totalPages = Math.ceil(visibleItemsCount / itemsPerPage);
        
        if (currentPage < totalPages) {
            currentPage++;
            applyFilters();
            updatePagination();
        }
    });

    // Ë©≥Á¥∞Ë®ò‰∫ãË°®Á§∫Ê©üËÉΩ
    readMoreBtns.forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            
            const newsItem = this.closest('.news-item');
            const newsData = extractNewsData(newsItem);
            showNewsDetail(newsData);
        });
    });

    function extractNewsData(newsItem) {
        return {
            title: newsItem.querySelector('.news-title').textContent,
            date: newsItem.querySelector('.news-date').textContent,
            category: newsItem.querySelector('.news-category').textContent,
            excerpt: newsItem.querySelector('.news-excerpt').textContent,
            tags: Array.from(newsItem.querySelectorAll('.news-tag')).map(tag => tag.textContent),
            image: newsItem.querySelector('.news-image-placeholder').className
        };
    }

    function showNewsDetail(newsData) {
        const modal = document.createElement('div');
        modal.className = 'news-detail-modal';
        modal.innerHTML = `
            <div class="modal-overlay"></div>
            <div class="modal-content">
                <button class="modal-close">&times;</button>
                <article class="news-detail">
                    <header class="news-detail-header">
                        <div class="news-detail-meta">
                            <span class="news-detail-date">${newsData.date}</span>
                            <span class="news-detail-category">${newsData.category}</span>
                        </div>
                        <h1 class="news-detail-title">${newsData.title}</h1>
                        <div class="news-detail-tags">
                            ${newsData.tags.map(tag => `<span class="news-detail-tag">${tag}</span>`).join('')}
                        </div>
                    </header>
                    <div class="news-detail-image">
                        <div class="news-detail-placeholder ${newsData.image}"></div>
                    </div>
                    <div class="news-detail-content">
                        <p>${newsData.excerpt}</p>
                        <p>„Åì„Å°„Çâ„ÅØË©≥Á¥∞Ë®ò‰∫ã„ÅÆÂÜÖÂÆπ„Åß„Åô„ÄÇÂÆüÈöõ„ÅÆ„Ç¶„Çß„Éñ„Çµ„Ç§„Éà„Åß„ÅØ„ÄÅ„Åì„Åì„Å´ÂÆåÂÖ®„Å™Ë®ò‰∫ãÂÜÖÂÆπ„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô„ÄÇ</p>
                        <p>ÂíåÁ≤ã„Åß„ÅØ„ÄÅ„ÅäÂÆ¢Êßò„Å´„Çà„ÇäËâØ„ÅÑ„Çµ„Éº„Éì„Çπ„Çí„ÅîÊèê‰æõ„Åô„Çã„Åü„ÇÅ„ÄÅÂ∏∏„Å´ÊîπÂñÑ„Å´Âä™„ÇÅ„Å¶„Åä„Çä„Åæ„Åô„ÄÇ„Åî‰∏çÊòé„Å™ÁÇπ„Åå„Åî„Åñ„ÅÑ„Åæ„Åó„Åü„Çâ„ÄÅ„ÅäÊ∞óËªΩ„Å´„ÅäÂïè„ÅÑÂêà„Çè„Åõ„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                        
                        <div class="news-detail-actions">
                            <button class="news-action-btn" onclick="window.print()">Âç∞Âà∑</button>
                            <button class="news-action-btn share-detail-btn">„Ç∑„Çß„Ç¢</button>
                        </div>
                    </div>
                </article>
            </div>
        `;

        // „É¢„Éº„ÉÄ„É´„Çπ„Çø„Ç§„É´
        const style = document.createElement('style');
        style.textContent = `
            .news-detail-modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 10000;
                display: flex;
                align-items: center;
                justify-content: center;
                opacity: 0;
                transition: opacity 0.3s ease;
            }
            .news-detail-modal.show {
                opacity: 1;
            }
            .modal-overlay {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(5px);
            }
            .modal-content {
                position: relative;
                background: white;
                border-radius: 12px;
                width: 90%;
                max-width: 800px;
                max-height: 90vh;
                overflow-y: auto;
                transform: scale(0.9);
                transition: transform 0.3s ease;
            }
            .news-detail-modal.show .modal-content {
                transform: scale(1);
            }
            .modal-close {
                position: absolute;
                top: 15px;
                right: 15px;
                background: none;
                border: none;
                font-size: 24px;
                cursor: pointer;
                z-index: 10001;
                color: var(--neutral-gray);
                padding: 10px;
            }
            .news-detail {
                padding: 2rem;
            }
            .news-detail-header {
                margin-bottom: 2rem;
            }
            .news-detail-meta {
                display: flex;
                gap: 1rem;
                margin-bottom: 1rem;
            }
            .news-detail-date {
                color: var(--neutral-gray);
            }
            .news-detail-category {
                background: var(--primary-green);
                color: white;
                padding: 4px 12px;
                border-radius: 12px;
                font-size: 0.9rem;
            }
            .news-detail-title {
                font-family: var(--font-serif);
                font-size: 2rem;
                color: var(--primary-green);
                margin-bottom: 1rem;
                line-height: 1.4;
            }
            .news-detail-tags {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            .news-detail-tag {
                background: var(--neutral-cream);
                color: var(--neutral-gray);
                padding: 4px 8px;
                border-radius: 12px;
                font-size: 0.8rem;
            }
            .news-detail-image {
                height: 300px;
                margin-bottom: 2rem;
                border-radius: 8px;
                overflow: hidden;
            }
            .news-detail-placeholder {
                width: 100%;
                height: 100%;
            }
            .news-detail-content {
                line-height: 1.8;
                color: var(--text-dark);
            }
            .news-detail-content p {
                margin-bottom: 1.5rem;
            }
            .news-detail-actions {
                display: flex;
                gap: 1rem;
                margin-top: 2rem;
                padding-top: 2rem;
                border-top: 1px solid var(--neutral-beige);
            }
            .news-action-btn {
                background: var(--primary-green);
                color: white;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 6px;
                cursor: pointer;
                font-weight: 500;
                transition: all 0.3s ease;
            }
            .news-action-btn:hover {
                background: var(--primary-green-dark);
                transform: translateY(-2px);
            }
            @media (max-width: 768px) {
                .modal-content {
                    width: 95%;
                    margin: 1rem;
                }
                .news-detail {
                    padding: 1rem;
                }
                .news-detail-title {
                    font-size: 1.5rem;
                }
                .news-detail-image {
                    height: 200px;
                }
            }
        `;
        document.head.appendChild(style);

        document.body.appendChild(modal);

        // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Ë°®Á§∫
        setTimeout(() => {
            modal.classList.add('show');
        }, 10);

        // Èñâ„Åò„ÇãÊ©üËÉΩ
        function closeModal() {
            modal.classList.remove('show');
            setTimeout(() => {
                document.body.removeChild(modal);
                document.head.removeChild(style);
            }, 300);
        }

        const closeBtn = modal.querySelector('.modal-close');
        const overlay = modal.querySelector('.modal-overlay');
        
        closeBtn.addEventListener('click', closeModal);
        overlay.addEventListener('click', closeModal);

        // ESC„Ç≠„Éº„ÅßÈñâ„Åò„Çã
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // „Ç∑„Çß„Ç¢Ê©üËÉΩ
        const shareDetailBtn = modal.querySelector('.share-detail-btn');
        shareDetailBtn.addEventListener('click', () => shareNews(newsData));
    }

    // „Ç∑„Çß„Ç¢Ê©üËÉΩ
    shareBtns.forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            
            const newsItem = this.closest('.news-item');
            const newsData = extractNewsData(newsItem);
            shareNews(newsData);
        });
    });

    function shareNews(newsData) {
        if (navigator.share) {
            navigator.share({
                title: newsData.title,
                text: newsData.excerpt,
                url: window.location.href
            }).catch(console.error);
        } else {
            // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: „ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº
            const shareText = `${newsData.title}\n${newsData.excerpt}\n${window.location.href}`;
            navigator.clipboard.writeText(shareText).then(() => {
                showToast('„É™„É≥„ÇØ„Çí„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü');
            }).catch(() => {
                // „Åï„Çâ„Å™„Çã„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: „Ç∑„Çß„Ç¢„É¢„Éº„ÉÄ„É´
                showShareModal(newsData);
            });
        }
    }

    function showShareModal(newsData) {
        const shareModal = document.createElement('div');
        shareModal.className = 'share-modal';
        shareModal.innerHTML = `
            <div class="modal-overlay"></div>
            <div class="modal-content">
                <button class="modal-close">&times;</button>
                <h3>Ë®ò‰∫ã„Çí„Ç∑„Çß„Ç¢</h3>
                <div class="share-options">
                    <button class="share-option twitter" data-platform="twitter">Twitter</button>
                    <button class="share-option facebook" data-platform="facebook">Facebook</button>
                    <button class="share-option line" data-platform="line">LINE</button>
                    <button class="share-option copy" data-platform="copy">„É™„É≥„ÇØ„Çí„Ç≥„Éî„Éº</button>
                </div>
            </div>
        `;

        document.body.appendChild(shareModal);
        
        // „Ç∑„Çß„Ç¢„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„Éà
        shareModal.querySelectorAll('.share-option').forEach(btn => {
            btn.addEventListener('click', function() {
                const platform = this.dataset.platform;
                shareToPlatform(platform, newsData);
                document.body.removeChild(shareModal);
            });
        });

        // Èñâ„Åò„ÇãÊ©üËÉΩ
        shareModal.querySelector('.modal-close').addEventListener('click', () => {
            document.body.removeChild(shareModal);
        });
    }

    function shareToplatform(platform, newsData) {
        const url = encodeURIComponent(window.location.href);
        const text = encodeURIComponent(`${newsData.title} - ${newsData.excerpt}`);
        
        const urls = {
            twitter: `https://twitter.com/intent/tweet?text=${text}&url=${url}`,
            facebook: `https://www.facebook.com/sharer/sharer.php?u=${url}`,
            line: `https://social-plugins.line.me/lineit/share?url=${url}&text=${text}`
        };

        if (platform === 'copy') {
            navigator.clipboard.writeText(window.location.href).then(() => {
                showToast('„É™„É≥„ÇØ„Çí„Ç≥„Éî„Éº„Åó„Åæ„Åó„Åü');
            });
        } else if (urls[platform]) {
            window.open(urls[platform], '_blank', 'width=600,height=400');
        }
    }

    // ÈáçË¶Å„Å™„ÅäÁü•„Çâ„Åõ„ÇíÈñâ„Åò„Çã
    if (noticeClose) {
        noticeClose.addEventListener('click', function() {
            const notice = this.closest('.important-notice');
            notice.style.transform = 'translateY(-100%)';
            notice.style.opacity = '0';
            
            setTimeout(() => {
                notice.style.display = 'none';
                localStorage.setItem('importantNoticeHidden', 'true');
            }, 300);
        });

        // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶Ë°®Á§∫Áä∂ÊÖã„ÇíÂæ©ÂÖÉ
        if (localStorage.getItem('importantNoticeHidden') === 'true') {
            document.querySelector('.important-notice').style.display = 'none';
        }
    }

    // „Éã„É•„Éº„Çπ„É¨„Çø„ÉºÁôªÈå≤
    if (newsletterForm) {
        newsletterForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const emailInput = this.querySelector('.newsletter-input');
            const submitBtn = this.querySelector('.newsletter-submit');
            const email = emailInput.value;
            
            if (!isValidEmail(email)) {
                showToast('ÊúâÂäπ„Å™„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }
            
            // ÈÄÅ‰ø°Âá¶ÁêÜ„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
            submitBtn.textContent = 'ÁôªÈå≤‰∏≠...';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                // ÊàêÂäüÂá¶ÁêÜ
                showToast('„Éã„É•„Éº„Çπ„É¨„Çø„Éº„ÅÆÁôªÈå≤„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü');
                emailInput.value = '';
                submitBtn.textContent = 'ÁôªÈå≤„Åô„Çã';
                submitBtn.disabled = false;
                
                // ÁôªÈå≤Áä∂Ê≥Å„Çí„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´‰øùÂ≠ò
                localStorage.setItem('newsletterSubscribed', 'true');
                
            }, 2000);
        });
    }

    function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }

    function showToast(message, type = 'success') {
        const toast = document.createElement('div');
        toast.className = `toast toast-${type}`;
        toast.textContent = message;
        toast.style.cssText = `
            position: fixed;
            top: 100px;
            right: 20px;
            background: ${type === 'success' ? 'var(--primary-green)' : '#f44336'};
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 300px;
        `;
        
        document.body.appendChild(toast);
        
        setTimeout(() => {
            toast.style.transform = 'translateX(0)';
        }, 100);
        
        setTimeout(() => {
            toast.style.transform = 'translateX(100%)';
            setTimeout(() => {
                document.body.removeChild(toast);
            }, 300);
        }, 3000);
    }

    // „Éá„Éê„Ç¶„É≥„ÇπÈñ¢Êï∞
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // „Éã„É•„Éº„Çπ„Ç¢„Ç§„ÉÜ„É†„ÅÆ„ÇØ„É™„ÉÉ„ÇØ„ÅßË©≥Á¥∞Ë°®Á§∫
    newsItems.forEach(item => {
        item.addEventListener('click', function(e) {
            if (!e.target.closest('.news-actions')) {
                const readMoreBtn = this.querySelector('.read-more-btn');
                readMoreBtn.click();
            }
        });
    });

    // „Çπ„ÇØ„É≠„Éº„É´ÊôÇ„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const fadeInObserver = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // „Éï„Çß„Éº„Éâ„Ç§„É≥Ë¶ÅÁ¥†„ÅÆÁõ£Ë¶ñ
    const fadeElements = document.querySelectorAll('.fade-in');
    fadeElements.forEach(element => {
        element.style.opacity = '0';
        element.style.transform = 'translateY(30px)';
        element.style.transition = 'all 0.6s ease';
        fadeInObserver.observe(element);
    });

    // „Ç¢„Éº„Ç´„Ç§„Éñ„É™„É≥„ÇØ„ÅÆÂãïÁöÑË™≠„ÅøËæº„ÅøÔºà„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥Ôºâ
    const archiveLinks = document.querySelectorAll('.archive-link');
    archiveLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            const linkText = this.textContent;
            showToast(`„Äå${linkText}„Äç„ÅÆË®ò‰∫ã„ÇíË™≠„ÅøËæº„Åø‰∏≠...`);
            
            // ÂÆüÈöõ„ÅÆ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Åß„ÅØ„ÄÅ„Åì„Åì„ÅßAPI„Åã„Çâ„Éá„Éº„Çø„ÇíÂèñÂæó
            setTimeout(() => {
                showToast('Ë®ò‰∫ã„ÅÆË™≠„ÅøËæº„Åø„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü');
            }, 1500);
        });
    });

    // URL„Éë„É©„É°„Éº„Çø„Åã„Çâ„Ç´„ÉÜ„Ç¥„É™„ÇíË®≠ÂÆö
    const urlParams = new URLSearchParams(window.location.search);
    const categoryParam = urlParams.get('category');
    
    if (categoryParam) {
        const targetBtn = document.querySelector(`[data-category="${categoryParam}"]`);
        if (targetBtn) {
            targetBtn.click();
        }
    }

    // ÂàùÊúüÂåñ
    applyFilters();
    updatePagination();

    // „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÁõ£Ë¶ñ
    if ('performance' in window) {
        window.addEventListener('load', function() {
            setTimeout(() => {
                const perfData = performance.getEntriesByType('navigation')[0];
                if (perfData.loadEventEnd - perfData.loadEventStart > 3000) {
                    console.warn('News page load time is slow');
                }
            }, 1000);
        });
    }

    // „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞
    window.addEventListener('error', function(e) {
        console.warn('News page error:', e.error);
    });
});